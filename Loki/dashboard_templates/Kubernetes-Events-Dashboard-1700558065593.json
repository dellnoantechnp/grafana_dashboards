{"__inputs":[{"name":"DS_LOKI","label":"Loki","description":"","type":"datasource","pluginId":"loki","pluginName":"Loki"}],"__elements":{},"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"10.1.1"},{"type":"panel","id":"logs","name":"Logs","version":""},{"type":"datasource","id":"loki","name":"Loki","version":"2.4.0"},{"type":"panel","id":"piechart","name":"Pie chart","version":""},{"type":"panel","id":"stat","name":"Stat","version":""},{"type":"panel","id":"table","name":"Table","version":""},{"type":"panel","id":"timeseries","name":"Time series","version":""}],"annotations":{"list":[{"builtIn":1,"datasource":{"type":"datasource","uid":"grafana"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","target":{"limit":100,"matchAny":false,"tags":[],"type":"dashboard"},"type":"dashboard"}]},"description":"Kubernetes Events Dashboard (Loki as DataSource)","editable":false,"fiscalYearStartMonth":0,"graphTooltip":0,"id":null,"links":[{"asDropdown":false,"icon":"external link","includeVars":false,"keepTime":false,"tags":[],"targetBlank":true,"title":"View in Github","tooltip":"","type":"link","url":"https://github.com/dellnoantechnp/grafana_dashboards"}],"liveNow":false,"panels":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"bars","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"displayName":"${__field.labels.severity}","mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"id":2,"interval":"1m","options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum by (type) (count_over_time({source=\"event-exporter\"}| json |  __error__=\"\" [$__interval]))","hide":true,"queryType":"range","range":true,"refId":"A"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum by (severity) (count_over_time({source=\"event-exporter\"} [$__interval]))","hide":false,"legendFormat":"","queryType":"range","range":true,"refId":"B"}],"title":"Kubernetes Events Overview","type":"timeseries"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":29,"gradientMode":"hue","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":true,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"red","value":1}]},"unit":"short"},"overrides":[{"matcher":{"id":"byName","options":"Warning"},"properties":[{"id":"color","value":{"fixedColor":"red","mode":"fixed"}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"id":4,"interval":"1m","options":{"legend":{"calcs":["sum"],"displayMode":"list","placement":"bottom","showLegend":true},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", severity=\"Warning\"}[$__interval]))","legendFormat":"Warning","queryType":"range","refId":"A"}],"title":"Warning Enents","type":"timeseries"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"noValue":"None","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":4,"x":0,"y":8},"id":6,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"Failed\"}[$__interval]))","hide":false,"legendFormat":"","queryType":"range","range":true,"refId":"B"}],"title":"Image Pull Failed","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"mappings":[],"noValue":"None","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]},"unit":"short"},"overrides":[]},"gridPos":{"h":6,"w":4,"x":4,"y":8},"id":12,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"BackOff\"}[$__interval]))","queryType":"range","range":true,"refId":"A"}],"title":"Container Crashed","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"noValue":"none","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":4,"x":8,"y":8},"id":10,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"OOMKilling\"}[$__interval]))","queryType":"range","range":true,"refId":"A"}],"title":"Container OOM Killed","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"noValue":"none","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":4,"x":12,"y":8},"id":14,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"Killing\"} [$__interval]))","queryType":"range","range":true,"refId":"A"}],"title":"Liveness Check Failed","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"noValue":"None","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":4,"x":16,"y":8},"id":16,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"text":{"valueSize":0},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"FailedScheduling\"} [$__interval]))","queryType":"range","range":true,"refId":"A"}],"title":"Schedule Failed","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"noValue":"None","thresholds":{"mode":"absolute","steps":[{"color":"yellow","value":null},{"color":"yellow","value":0}]}},"overrides":[]},"gridPos":{"h":6,"w":4,"x":20,"y":8},"id":18,"interval":"1m","options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"text":{},"textMode":"auto"},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"TaintManagerEviction\"}|= \"Marking for deletion Pod\"| json | reason = \"TaintManagerEviction\"| __error__=\"\"[$__interval]))","hide":true,"queryType":"range","range":true,"refId":"A"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\", reason=\"TaintManagerEviction\"} |= \"Marking for deletion Pod\"| logfmt | __error__=\"\"[$__interval]))","hide":false,"queryType":"range","range":true,"refId":"B"}],"title":"Pod Evicted","type":"stat"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"description":"","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"filterable":false,"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":0}]}},"overrides":[{"matcher":{"id":"byName","options":"Field"},"properties":[{"id":"color","value":{"mode":"thresholds"}},{"id":"displayName","value":"Reason"},{"id":"color","value":{"fixedColor":"#eab839","mode":"fixed"}},{"id":"custom.align","value":"center"},{"id":"custom.width","value":300},{"id":"custom.cellOptions","value":{"mode":"gradient","type":"color-background"}}]},{"matcher":{"id":"byName","options":"Total"},"properties":[{"id":"color","value":{"mode":"continuous-BlYlRd"}},{"id":"custom.cellOptions","value":{"mode":"gradient","type":"gauge"}},{"id":"custom.align","value":"center"}]}]},"gridPos":{"h":14,"w":12,"x":0,"y":14},"id":26,"interval":"1m","options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"frameIndex":1,"showHeader":true,"sortBy":[{"desc":false,"displayName":"Total"}]},"pluginVersion":"10.1.1","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"topk(10,sum by (reason) (count_over_time({source=\"event-exporter\"}[$__interval])))","instant":false,"legendFormat":"{{reason}}","range":true,"refId":"A"}],"title":"TOP 10  Kubernetes Events","transformations":[{"id":"reduce","options":{"labelsToFields":false,"reducers":["sum"]}}],"type":"table"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":14,"w":6,"x":12,"y":14},"id":20,"interval":"1m","options":{"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"pieType":"pie","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\"} [$__interval])) by (component)","legendFormat":"{{source_component}}","range":true,"refId":"A"}],"title":"Kubernetes Events Source","type":"piechart"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]},"overrides":[]},"gridPos":{"h":14,"w":6,"x":18,"y":14},"id":22,"interval":"1m","options":{"legend":{"displayMode":"list","placement":"bottom","showLegend":true},"pieType":"pie","reduceOptions":{"calcs":["sum"],"fields":"","values":false},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"sum(count_over_time({source=\"event-exporter\"}[$__interval])) by (kind)","legendFormat":"{{involvedObject_kind}}","range":true,"refId":"A"}],"title":"Kubernetes  Events Type","type":"piechart"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"gridPos":{"h":19,"w":24,"x":0,"y":28},"id":8,"options":{"dedupStrategy":"none","enableLogDetails":true,"prettifyLogMessage":false,"showCommonLabels":false,"showLabels":false,"showTime":true,"sortOrder":"Descending","wrapLogMessage":true},"targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"editorMode":"code","expr":"{source=\"event-exporter\"}","range":true,"refId":"A"}],"title":"Kubernetes Live Events","type":"logs"}],"refresh":"1m","schemaVersion":38,"style":"dark","tags":["Loki","logging"],"templating":{"list":[{"current":{"selected":false,"text":"Loki","value":"loki-datasource-uid"},"hide":0,"includeAll":false,"label":"Datasource","multi":false,"name":"DS_LOKI","options":[],"query":"loki","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"}]},"time":{"from":"now-6h","to":"now"},"timepicker":{"refresh_intervals":["10s","30s","1m","5m","15m","30m","1h","2h","1d"]},"timezone":"","title":"Kubernetes Events Dashboard","version":1,"weekStart":""}